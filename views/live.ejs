<%- include('partials/header') %>

<div class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-8 px-4">
  <div class="max-w-6xl mx-auto">
    <!-- Header Section -->
    <div class="text-center mb-10">
      <h1 class="text-4xl font-bold text-gray-800 mb-4">সদস্য তালিকা</h1>
      <p class="text-xl text-gray-600 max-w-2xl mx-auto">আমাদের কমিউনিটির সকল সদস্যদের তালিকা এবং তাদের লাইভ স্ট্যাটাস</p>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <div class="bg-white p-6 rounded-xl shadow-md border-l-4 border-blue-500">
        <h3 class="text-lg font-semibold text-gray-700 mb-2">মোট সদস্য</h3>
        <p class="text-3xl font-bold text-blue-600"><%= user.length %></p>
      </div>
      <div class="bg-white p-6 rounded-xl shadow-md border-l-4 border-green-500">
        <h3 class="text-lg font-semibold text-gray-700 mb-2">লাইভ সদস্য</h3>
        <p class="text-3xl font-bold text-green-600">
          <%= user.filter(u => u.live).length %>
        </p>
      </div>
      <div class="bg-white p-6 rounded-xl shadow-md border-l-4 border-purple-500">
        <h3 class="text-lg font-semibold text-gray-700 mb-2">ভিউয়ার সদস্য</h3>
        <p class="text-3xl font-bold text-purple-600">
          <%= user.filter(u => !u.live).length %>
        </p>
      </div>
    </div>

    <% if(user && user.length > 0) { %>
      <!-- Desktop Table (hidden on mobile) -->
      <div class="hidden md:block bg-white rounded-xl shadow-md overflow-hidden mb-8">
        <table class="w-full">
          <thead>
            <tr class="bg-gray-50 border-b border-gray-200">
              <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">সদস্য</th>
              <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ইমেইল</th>
              <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ফেসবুক আইডি</th>
              <th class="px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">লাইভ স্ট্যাটাস</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200">
            <% user.forEach(u => { %>
            <tr class="hover:bg-gray-50 transition-colors duration-200">
              <!-- Name -->
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <div class="flex-shrink-0 h-12 w-12">
                    <img class="h-12 w-12 rounded-full object-cover border-2 border-white shadow-sm" src="<%- u.imageUrl || '/default-avatar.png' %>" alt="<%- u.username %>">
                  </div>
                  <div class="ml-4">
                    <div class="text-sm font-medium text-gray-900"><%- u.username %></div>
                    <div class="text-sm text-gray-500">Member since: <%- new Date(u.createdAt || Date.now()).toLocaleDateString() %></div>
                  </div>
                </div>
              </td>

              <!-- Email -->
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-gray-900"><%- u.email %></div>
              </td>

              <!-- FB ID -->
              <td class="px-6 py-4 whitespace-nowrap">
                <% if(u.fb) { %>
                <a href="<%- u.fb || '#' %>" target="_blank" class="inline-flex items-center text-blue-600 hover:text-blue-800 transition-colors duration-200">
                  <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                  </svg>
                  ফেসবুক প্রোফাইল
                </a>
                <% } else { %>
                <span class="text-sm text-gray-900 relative left-5">---</span>
                <% } %>
              </td>

              <!-- Live Status -->
              <td class="px-6 py-4 whitespace-nowrap text-center">
                <% if(u.live) { %>
                  <a href="/liver/<%- u._id %>" class="inline-flex items-center px-3 py-1 
                  rounded-full text-sm font-medium bg-green-400 text-white font-semibold">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    লাইভ
                  </a>
                <% } else { %>
                  <a href="/setlive/<%- u._id %>" class="inline-flex items-center px-3 py-1 rounded-md text-sm font-medium bg-gray-800 text-white hover:bg-gray-900 transition-colors duration-200 cursor-pointer">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                    </svg>
                    লাইভ সেট করুন
                  </a>
                <% } %>
              </td>
            </tr>
            <% }) %>
          </tbody>
        </table>
      </div>

      <!-- Mobile Cards (visible only on mobile) -->
      <div class="md:hidden grid grid-cols-1 gap-6">
        <% user.forEach(u => { %>
        <div class="bg-white rounded-xl shadow-md p-6">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center">
              <img class="h-14 w-14 rounded-full object-cover border-2 border-white shadow-sm" src="<%- u.imageUrl || '/default-avatar.png' %>" alt="<%- u.username %>">
              <div class="ml-4">
                <h3 class="text-lg font-medium text-gray-900"><%- u.username %></h3>
                <p class="text-sm text-gray-500"><%- u.email %></p>
              </div>
            </div>
            <% if(u.live) { %>
              <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                লাইভ
              </span>
            <% } %>
          </div>
          
          <div class="grid grid-cols-2 gap-4 mb-4">
            <div>
              <p class="text-xs text-gray-500">ফেসবুক আইডি</p>
              <a href="<%- u.fb || '#' %>"  class="text-sm text-blue-600 hover:text-blue-800 transition-colors duration-200 flex items-center">
                <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                </svg>
                প্রোফাইল
              </a>
            </div>
            <div>
              <p class="text-xs text-gray-500">মেম্বার sejak</p>
              <p class="text-sm text-gray-900"><%- new Date(u.createdAt || Date.now()).toLocaleDateString() %></p>
            </div>
          </div>
          
          <% if(!u.live) { %>
            <a href="/setlive/<%- u._id %>" class="w-full flex items-center justify-center px-4 py-2 bg-gray-800 text-white rounded-md hover:bg-gray-900 transition-colors duration-200 cursor-pointer">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
              </svg>
              লাইভ সেট করুন
            </a>
          <% } %>
        </div>
        <% }) %>
      </div>
    <% } else { %>
      <!-- Empty State -->
      <div class="bg-white rounded-xl shadow-md p-8 text-center">
        <svg class="w-16 h-16 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
        </svg>
        <h3 class="text-xl font-semibold text-gray-700 mb-2">কোনো সদস্য নেই</h3>
        <p class="text-gray-500 mb-4">এখনও কোনো সদস্য রেজিস্ট্রেশন করেননি</p>
        <a href="/register" class="inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors duration-300">
          প্রথম সদস্য হোন
        </a>
      </div>
    <% } %>
  </div>
</div>

<%- include('partials/footer') %>